<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="ja-JP">
  <link rel="stylesheet" type="text/css" href="../style.css">
  <link rel="icon" type="image/png" href="../rurema.png">
  <title>module WIN32OLE::VARIANT</title>
</head>
<body>

<p>
<a href="../doc/index.html">Ruby 2.1.0 リファレンスマニュアル</a>
&gt; <a href="../library/index.html">ライブラリ一覧</a>
&gt; <a href="../library/win32ole.html">win32oleライブラリ</a>
&gt; WIN32OLE::VARIANTモジュール
</p>


<h1>module WIN32OLE::VARIANT</h1>
<p>


クラスの継承リスト: WIN32OLE::VARIANT







</p>

<h2>要約</h2>
<p>
OLEオートメーション型を指定するための定数を定義したモジュールです。
</p>
<p>
WIN32OLE::VARIANTは、<a href="../class/-w-i-n32-o-l-e_-v-a-r-i-a-n-t.html">WIN32OLE_VARIANT</a>オブジェクトの作成時や、
<a href="../method/-w-i-n32-o-l-e/i/_invoke.html">WIN32OLE#_invoke</a>などのメソッド呼び出し時に、ユーザがRubyのオブジェ
クトの変換方法を指定するための定数を提供します。
</p>
<p>
これらの値は、COMの仕様で定義されたOLEオートメーション型と呼ばれる一連
の型を決定する定数です。ただし、一部、OLEオートメーション非互換の型も定
義されているため、利用時にはOLEオートメーション互換型のみを利用するよう
にしてください。
</p>



<h2>目次</h2>
<dl>

<dt>定数</dt>
<dd>

<a href="#C_-V-T_-A-R-R-A-Y">VT_ARRAY</a>

<a href="#C_-V-T_-B-O-O-L">VT_BOOL</a>

<a href="#C_-V-T_-B-S-T-R">VT_BSTR</a>

<a href="#C_-V-T_-B-Y-R-E-F">VT_BYREF</a>

<a href="#C_-V-T_-C-Y">VT_CY</a>

<a href="#C_-V-T_-D-A-T-E">VT_DATE</a>

<a href="#C_-V-T_-D-I-S-P-A-T-C-H">VT_DISPATCH</a>

<a href="#C_-V-T_-E-M-P-T-Y">VT_EMPTY</a>

<a href="#C_-V-T_-E-R-R-O-R">VT_ERROR</a>

<a href="#C_-V-T_-I1">VT_I1</a>

<a href="#C_-V-T_-I2">VT_I2</a>

<a href="#C_-V-T_-I4">VT_I4</a>

<a href="#C_-V-T_-I-N-T">VT_INT</a>

<a href="#C_-V-T_-N-U-L-L">VT_NULL</a>

<a href="#C_-V-T_-P-T-R">VT_PTR</a>

<a href="#C_-V-T_-R4">VT_R4</a>

<a href="#C_-V-T_-R8">VT_R8</a>

<a href="#C_-V-T_-U-I1">VT_UI1</a>

<a href="#C_-V-T_-U-I2">VT_UI2</a>

<a href="#C_-V-T_-U-I4">VT_UI4</a>

<a href="#C_-V-T_-U-I-N-T">VT_UINT</a>

<a href="#C_-V-T_-U-N-K-N-O-W-N">VT_UNKNOWN</a>

<a href="#C_-V-T_-U-S-E-R-D-E-F-I-N-E-D">VT_USERDEFINED</a>

<a href="#C_-V-T_-V-A-R-I-A-N-T">VT_VARIANT</a>

</dd>

</dl>


<h2>定数</h2>
<dl>

<dt class="method-heading" id="C_-V-T_-A-R-R-A-Y"><code>VT_ARRAY -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-a-r-r-a-y.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_ARRAY">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
配列（SafeArray）を示します（0x2000）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-O-O-L"><code>VT_BOOL -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-b-o-o-l.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_BOOL">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
真偽値を示します（11）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-S-T-R"><code>VT_BSTR -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-b-s-t-r.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_BSTR">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
文字列（BSTR）を示します（8）。
</p>
<p>
OLEオートメーションのBSTRはUnicodeで表現された長さ付き文字列です。Ruby
のStringとBSTRの相互変換は、WIN32OLEが<a href="../method/-w-i-n32-o-l-e/i/codepage.html">WIN32OLE#codepage</a>に基づいて
自動的に行います。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-Y-R-E-F"><code>VT_BYREF -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-b-y-r-e-f.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_BYREF">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
参照を示します（0x4000）。
</p>
<p>
VT_BYREFは型ではなく、参照を示す型属性です。OLEオートメーションサーバが
結果を引数に戻す場合、参照先の型を示す値と論理和を取るために利用します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-C-Y"><code>VT_CY -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-c-y.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_CY">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
通貨型（CURRENCY）を示します（6）。
</p>
<p>
OLEオートメーションのCURRENCY型は、符号付き64ビット整数を10進表記した時
の下4桁を小数点以下とすることで、加減算について誤差を生じさせない小数点
数を表現します。
</p>
<p>
CURRENCY型の有効範囲は-922337203685477.5808から922337203685477.5807です。
</p>
<p>
WIN32OLEはオートメーション呼び出しの返り値がCURRENCY型の場合、文字列に
変換します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-D-A-T-E"><code>VT_DATE -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-d-a-t-e.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_DATE">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
日付型（DATE）を示します（7）。
</p>
<p>
OLEオートメーションのDATE型は、1899年12月30日0時00分からの日時を示す64
ビット浮動小数点数型です。
</p>
<p>
WIN32OLEは、RubyのTime型と自動的に変換します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-D-I-S-P-A-T-C-H"><code>VT_DISPATCH -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-d-i-s-p-a-t-c-h.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_DISPATCH">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
OLEオートメーションオブジェクトを示します（9）。
</p>
<p>
RubyのオブジェクトをOLEオートメーションサーバへ与える場合に利用します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-E-M-P-T-Y"><code>VT_EMPTY -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-e-m-p-t-y.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_EMPTY">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
空（初期化状態）のオブジェクトを示します（0）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-E-R-R-O-R"><code>VT_ERROR -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-e-r-r-o-r.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_ERROR">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
HRESULTを示します（10）。
</p>
<p>
HRESULTは、COMを含むWindowsのサービスがアプリケーションへ通知する統一的
なエラーコードです。
</p>
<p>
HRESULT: <a class="external" href="http://msdn.microsoft.com/en-us/library/cc704587(v=PROT.10).aspx">http://msdn.microsoft.com/en-us/library/cc704587(v=PROT.10).aspx</a>
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I1"><code>VT_I1 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-i1.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_I1">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号付き8ビット整数（char）を示します（16）。
</p>
<p>
OLEオートメーションの仕様上は利用できません。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I2"><code>VT_I2 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-i2.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_I2">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号付き16ビット整数（short）を示します（2）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I4"><code>VT_I4 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-i4.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_I4">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号付き32ビット整数（int）を示します（3）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I-N-T"><code>VT_INT -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-i-n-t.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_INT">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号付き整数（int）を示します（22）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-N-U-L-L"><code>VT_NULL -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-n-u-l-l.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_NULL">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
NULL型の値を示します（1）。
</p>
<p>
<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/s/-v-t_-e-m-p-t-y.html">WIN32OLE::VARIANT.VT_EMPTY</a>と異なり、NULLという値（たとえばSQLパラ
メータでNULLを指定する場合など）を示します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-P-T-R"><code>VT_PTR -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-p-t-r.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_PTR">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
ポインタ型を示します（26）。
</p>
<p>
VT_PTRは、VOID*に相当するため、OLEオートメーションでは利用できません。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-R4"><code>VT_R4 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-r4.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_R4">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
単精度浮動小数点数を示します（4）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-R8"><code>VT_R8 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-r8.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_R8">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
倍精度浮動小数点数を示します（5）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I1"><code>VT_UI1 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-i1.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_UI1">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号なし8ビット整数（unsigned char）を示します（17）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I2"><code>VT_UI2 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-i2.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_UI2">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号なし16ビット整数（unsigned short）を示します（18）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I2を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I4"><code>VT_UI4 -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-i4.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_UI4">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号なし32ビット整数（unsigned int）を示します（19）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I-N-T"><code>VT_UINT -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-i-n-t.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_UINT">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
符号なし整数（unsigned int）を示します（23）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-N-K-N-O-W-N"><code>VT_UNKNOWN -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-n-k-n-o-w-n.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_UNKNOWN">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
COMインターフェイスを示します（13）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-S-E-R-D-E-F-I-N-E-D"><code>VT_USERDEFINED -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-u-s-e-r-d-e-f-i-n-e-d.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_USERDEFINED">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
ユーザ定義型を示します（29）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-V-A-R-I-A-N-T"><code>VT_VARIANT -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e=3a=3a-v-a-r-i-a-n-t/c/-v-t_-v-a-r-i-a-n-t.html">permalink</a>][<a href="http://ruby-doc.org/stdlib-2.1.0/libdoc/win32ole/rdoc/WIN32OLE/VARIANT.html#method-c-VT_VARIANT">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
VARIANT型を示します（12）。
</p>
</dd>


</dl>



<div id="footer">
  <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">
    <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png" />
  </a>
</div>
</body>
</html>
