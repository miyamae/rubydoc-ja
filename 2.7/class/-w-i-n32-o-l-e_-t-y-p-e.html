<!DOCTYPE html>
<html lang="ja-JP">
<head>

<meta name="robots" content="noindex">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../syntax-highlight.css">
<link rel="icon" type="image/png" href="../rurema.png">

<title>class WIN32OLE_TYPE (Ruby 2.7.6 リファレンスマニュアル)</title>
<meta name="description" content="WIN32OLE_TYPEオブジェクトは、型情報ライブラリ（TypeLib）内に定義された
1つの型情報を保持します。">
<script src="../script.js"></script>
</head>
<body>


<header>
  <nav>
    <ol class="inline-breadcrumb-list">
      <li>
        <a href="../doc/index.html">Ruby 2.7.6 リファレンスマニュアル</a>
      </li>
      <li>
        <a href="../library/index.html">ライブラリ一覧</a>
      </li>
      <li>
        <a href="../library/win32ole.html">win32oleライブラリ</a>
      </li>
      <li>
        WIN32OLE_TYPEクラス
      </li>
    </ol>
  </nav>

<h1>class WIN32OLE_TYPE</h1>
</header>

<main>



  <nav>
    クラス・モジュールの継承リスト:
    <ol class="inline-ancestors-list">
      
        <li>
          <a href="../class/-basic-object.html">BasicObject</a>
        </li>
        
      
        <li>
          <a href="../class/-kernel.html">Kernel</a>
        </li>
        
      
        <li>
          <a href="../class/-object.html">Object</a>
        </li>
        
      
      <li>
        WIN32OLE_TYPE
      </li>
    </ol>
  </nav>











<h2>要約</h2>
<p>
WIN32OLE_TYPEオブジェクトは、型情報ライブラリ（TypeLib）内に定義された
1つの型情報を保持します。
</p>
<h2 >サンプルコード</h2>
<pre>
require 'win32ole'

excel_app_type = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
puts excel_app_type.progid # =&gt; &quot;Excel.Application.14&quot;
</pre>
<p>
Ruby-1.9.1以降、<a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>オブジェクトの
<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/ole_types.html">WIN32OLE_TYPELIB#ole_types</a>メソッドを利用して、型情報ライブラリ内に定義されているすべての型情報をWIN32OLE_TYPEオブジェクトの配列として取得できます。
</p>
<p>
@see <a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>
</p>



<h2>目次</h2>
<dl>

<dt>特異メソッド</dt>
<dd>
<ul class="class-toc">

<li><a href="#S_NEW">new</a></li>

<li><a href="#S_OLE_CLASSES">ole_classes</a></li>

<li><a href="#S_PROGIDS">progids</a></li>

<li><a href="#S_TYPELIBS">typelibs</a></li>

</ul>
</dd>

<dt>インスタンスメソッド</dt>
<dd>
<ul class="class-toc">

<li><a href="#I_DEFAULT_EVENT_SOURCES">default_event_sources</a></li>

<li><a href="#I_DEFAULT_OLE_TYPES">default_ole_types</a></li>

<li><a href="#I_GUID">guid</a></li>

<li><a href="#I_HELPCONTEXT">helpcontext</a></li>

<li><a href="#I_HELPFILE">helpfile</a></li>

<li><a href="#I_HELPSTRING">helpstring</a></li>

<li><a href="#I_IMPLEMENTED_OLE_TYPES">implemented_ole_types</a></li>

<li><a href="#I_INSPECT">inspect</a></li>

<li><a href="#I_MAJOR_VERSION">major_version</a></li>

<li><a href="#I_MINOR_VERSION">minor_version</a></li>

<li><a href="#I_NAME">name</a></li>

<li><a href="#I_OLE_METHODS">ole_methods</a></li>

<li><a href="#I_OLE_TYPE">ole_type</a></li>

<li><a href="#I_OLE_TYPELIB">ole_typelib</a></li>

<li><a href="#I_PROGID">progid</a></li>

<li><a href="#I_SOURCE_OLE_TYPES">source_ole_types</a></li>

<li><a href="#I_SRC_TYPE">src_type</a></li>

<li><a href="#I_NAME">to_s</a></li>

<li><a href="#I_TYPEKIND">typekind</a></li>

<li><a href="#I_VARIABLES">variables</a></li>

<li><a href="#I_VISIBLE--3F">visible?</a></li>

</ul>
</dd>

</dl>




</dl>


<h2>特異メソッド</h2>
<dl>

<dt class="method-heading" id="S_NEW"><code>new(libname, ole_class) -&gt; WIN32OLE_TYPE</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/s/new.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-c-new">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
WIN32OLE_TYPEオブジェクトを生成します。
</p>
<dl>
<dt class='method-param'>[PARAM] libname:</dt>
<dd>
生成するTypeLibのレジストリ上のドキュメント文字列（<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/name.html">WIN32OLE_TYPELIB#name</a>）または
GUID（<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/guid.html">WIN32OLE_TYPELIB#guid</a>）またはTLBファイル名を文字列で指定します。
</dd>
<dt class='method-param'>[PARAM] ole_class:</dt>
<dd>
型情報を取り出す型の名前を指定します。
</dd>
<dt>[RETURN]</dt>
<dd>
指定されたTypeLIbに定義された型の情報を格納したWIN32OLE_TYPEオブジェクトを返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
TypeLibが見つかりません。またはole_classで指定した型が未定義です。
</dd>
</dl>
<pre>
excel_app_type = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
puts excel_app_type.progid # =&gt; &quot;Excel.Application.14&quot;
</pre>
<p>
TypeLibに定義されているすべての型を取得するには、
<a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>オブジェクトの<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/ole_types.html">WIN32OLE_TYPELIB#ole_types</a>メソッドを利用します。
</p>
</dd>


<dt class="method-heading" id="S_OLE_CLASSES"><code>ole_classes(libname) -&gt; [WIN32OLE_TYPE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/s/ole_classes.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-c-ole_classes">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
TypeLibで定義されているすべての型情報を取得します。
</p>
<dl>
<dt class='method-param'>[PARAM] libname:</dt>
<dd>
生成するTypeLibのレジストリ上のドキュメント文字列（<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/name.html">WIN32OLE_TYPELIB#name</a>）または
GUID（<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/guid.html">WIN32OLE_TYPELIB#guid</a>）またはTLBファイル名を文字列で指定します。
</dd>
<dt>[RETURN]</dt>
<dd>
TypeLibに格納されているすべての型を<a href="../class/-w-i-n32-o-l-e_-t-y-p-e.html">WIN32OLE_TYPE</a>オブジェクトの配列として返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
引数で指定したTypeLibが見つかりません。
</dd>
</dl>
<pre>
types = WIN32OLE_TYPE.ole_classes('Microsoft Excel 14.0 Object Library')
classes = types.map{|k| k.name} # =&gt; [&quot;Adjustments&quot;, &quot;CalloutFormat&quot;, ...]
</pre>
<p>
Ruby-1.9.1からは、TypeLibに定義されているすべての型を取得するには、
<a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>オブジェクトの<a href="../method/-w-i-n32-o-l-e_-t-y-p-e-l-i-b/i/ole_types.html">WIN32OLE_TYPELIB#ole_types</a>メソッドを利用してください。
</p>
</dd>


<dt class="method-heading" id="S_PROGIDS"><code>progids -&gt; [String]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/s/progids.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-c-progids">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
システムに登録されているすべてのコンポーネントクラスのPROGIDを取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
システムに登録されているすべてのコンポーネントクラスのPROGIDを文字列配列で返します。
</dd>
</dl>
<pre>
excel = nil
WIN32OLE_TYPE.progids.each do |pg|
  if pg =~ /excel\.application/i   # ExcelのPROGIDをバージョン無視で取り出す
    excel = WIN32OLE.new(pg)
    break
  end
end
unless excel
  $stderr.puts &quot;Excel isn't installed&quot;
  exit(1)
end
excel.visible = true
# ...
excel.Quit
</pre>
<p>
PROGIDは、生成可能なOLEオートメーションサーバのCoClass（コンポーネントクラス）が持つレジストリ登録名です。<a href="../method/-w-i-n32-o-l-e/s/new.html">WIN32OLE.new</a>の引数に指定して
WIN32OLEオブジェクトを生成できます。
</p>
</dd>


<dt class="method-heading" id="S_TYPELIBS"><code>typelibs -&gt; [String]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/s/typelibs.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-c-typelibs">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
システムに登録されているすべてのTypeLibのドキュメント文字列を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
システムに登録されているすべてのTypeLibのドキュメント文字列の配列を返します。
</dd>
</dl>
<p>
Ruby-1.9.1からは、すべてのTypeLibのドキュメント文字列を取得するには、
<a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>オブジェクトを利用して、以下のように記述してください。
</p>
<pre>
WIN32OLE_TYPELIB.typelibs.map {|t| t.name}
</pre>
</dd>


</dl>

<h2>インスタンスメソッド</h2>
<dl>

<dt class="method-heading" id="I_DEFAULT_EVENT_SOURCES"><code>default_event_sources -&gt; [WIN32OLE_TYPE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/default_event_sources.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-default_event_sources">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型が持つソースインターフェイスを取得します。
</p>
<p>
default_event_sourcesメソッドは、selfがCoClass（コンポーネントクラス）の場合、そのクラスがサポートするデフォルトのソースインターフェイス（イベントの通知元となるインターフェイス）を返します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
デフォルトのソースインターフェイスを<a href="../class/-w-i-n32-o-l-e_-t-y-p-e.html">WIN32OLE_TYPE</a>の配列として返します。返すのは配列ですが、デフォルトのソースインターフェイスは最大でも1インターフェイスです。ソースインターフェイスを持たない場合は空配列を返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
tobj.default_event_sources.map {|intf| intf.name} #=&gt; [&quot;DocEvents&quot;]
</pre>
<p>
<a href="../method/-w-i-n32-o-l-e_-e-v-e-n-t/s/new.html">WIN32OLE_EVENT.new</a>でインターフェイス名を指定しない場合は、ここで返されたインターフェイスが選択されます。
</p>
<p>
次のサンプルは、IEのnaviaget2メソッドによってどのようなイベントが通知されるかを、実際にメソッド呼び出し（=イベント通知）をトレースして調べるプログラムです。イベントを受け付けるために、
<a href="../method/-w-i-n32-o-l-e_-e-v-e-n-t/s/message_loop.html">WIN32OLE_EVENT.message_loop</a>の呼び出しが必要な点に注意してください。ここでは最終イベントのStatusTextChangeイベントのメッセージについては既知としています。
</p>
<pre>
# coding : cp932
require 'win32ole'

type = WIN32OLE_TYPE.new('Microsoft Internet Controls', 'InternetExplorer')
ctl = WIN32OLE.new(type.progid)
source = type.default_event_sources[0]
class WebEvent
  def initialize
    @completed = false
  end
  attr_reader :completed
end
source.ole_methods.each do |m|
  WebEvent.module_eval do
    define_method(&quot;on#{m.name}&quot;) do |*arg|
      if arg[0] == &quot;ページが表示されました&quot;
        @completed = true
      end
      puts &quot;#{Time.now}: #{m.name} was called&quot;
      p arg
    end
  end
end
evt = WIN32OLE_EVENT.new(ctl)
evt.handler = WebEvent.new
ctl.navigate2 'http://www.ruby-lang.org/'
loop do
  break if evt.handler.completed
  WIN32OLE_EVENT.message_loop
end
ctl.Quit
</pre>
<p>
このプログラムを実行するとWindows7のIE8環境では以下のような出力を得られます。
</p>
<pre>
2010-10-06 22:33:54 +0900: PropertyChange was called
[&quot;{265b75c1-4158-11d0-90f6-00c04fd497ea}&quot;]
2010-10-06 22:33:54 +0900: BeforeNavigate2 was called
[#&lt;WIN32OLE:0x9d08f0&gt;, &quot;http://www.ruby-lang.org/&quot;, 0, &quot;&quot;, nil, &quot;&quot;, false]
2010-10-06 22:33:54 +0900: DownloadBegin was called
[]
2010-10-06 22:33:54 +0900: PropertyChange was called
[&quot;{D0FCA420-D3F5-11CF-B211-00AA004AE837}&quot;]
2010-10-06 22:33:54 +0900: CommandStateChange was called
[2, false]
2010-10-06 22:33:54 +0900: CommandStateChange was called
[1, false]
2010-10-06 22:33:54 +0900: StatusTextChange was called
[&quot;www.ruby-lang.org を検索しています&quot;]
2010-10-06 22:33:54 +0900: ProgressChange was called
[100, 10000]
2010-10-06 22:33:54 +0900: StatusTextChange was called
[&quot;サイト 221.186.184.68 に接続しています&quot;]
2010-10-06 22:33:54 +0900: StatusTextChange was called
[&quot;Web サイトが見つかりました。応答を待っています...&quot;]
……
2010-10-06 22:33:54 +0900: TitleChange was called
[&quot;オブジェクト指向スクリプト言語 Ruby&quot;]
2010-10-06 22:33:54 +0900: StatusTextChange was called
[&quot;待機中: http://www.ruby-lang.org/ja/ ...&quot;]
2010-10-06 22:33:54 +0900: ProgressChange was called
[10000, 10000]
2010-10-06 22:33:54 +0900: ProgressChange was called
[-1, 10000]
2010-10-06 22:33:54 +0900: DownloadComplete was called
[]
2010-10-06 22:33:54 +0900: ProgressChange was called
[10000, 10000]
2010-10-06 22:33:54 +0900: DocumentComplete was called
[#&lt;WIN32OLE:0x438a2f8&gt;, &quot;http://www.ruby-lang.org/ja/&quot;]
2010-10-06 22:33:54 +0900: StatusTextChange was called
[&quot;ページが表示されました&quot;]
</pre>
<p>
[SEE_ALSO] <a href="../method/-w-i-n32-o-l-e_-t-y-p-e/s/new.html">WIN32OLE_TYPE.new</a>, <a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/progid.html">WIN32OLE_TYPE#progid</a>,
<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_methods.html">WIN32OLE_TYPE#ole_methods</a>, <a href="../method/-w-i-n32-o-l-e_-m-e-t-h-o-d/i/name.html">WIN32OLE_METHOD#name</a>,
<a href="../method/-w-i-n32-o-l-e_-e-v-e-n-t/s/new.html">WIN32OLE_EVENT.new</a>, <a href="../method/-w-i-n32-o-l-e_-e-v-e-n-t/i/handler=3d.html">WIN32OLE_EVENT#handler=</a>,
<a href="../method/-w-i-n32-o-l-e_-e-v-e-n-t/s/message_loop.html">WIN32OLE_EVENT.message_loop</a>
</p>
</dd>


<dt class="method-heading" id="I_DEFAULT_OLE_TYPES"><code>default_ole_types -&gt; [WIN32OLE_TYPE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/default_ole_types.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-default_ole_types">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型が持つデフォルトのインターフェイスを取得します。
</p>
<p>
default_ole_typesメソッドは、selfがCoClass（コンポーネントクラス）の場合、そのクラスが実装しているデフォルトのインターフェイスと、サポートしていればデフォルトのソースインターフェイスを返します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
デフォルトインターフェイスを<a href="../class/-w-i-n32-o-l-e_-t-y-p-e.html">WIN32OLE_TYPE</a>の配列として返します。デフォルトインターフェイスは、最大でも、クラス操作用のインターフェイス（OLEオートメーション用）と、イベント用のソースインターフェイスの2要素です。デフォルトインターフェイスを持たない場合は空配列を返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
tobj.default_ole_types.map {|intf| intf.name} #=&gt; [&quot;_Worksheet&quot;, &quot;DocEvents&quot;]
</pre>
</dd>


<dt class="method-heading" id="I_GUID"><code>guid -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/guid.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-guid">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
この型のGUID（グローバル一意識別子）を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
GUIDを文字列で返します。GUIDを持たない型の場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
puts tobj.guid  # =&gt; {00024500-0000-0000-C000-000000000046}
</pre>
<p>
GUIDは、COMのクラス識別子(CLSID)、インターフェイス識別子(IID)など多数の領域でWindows上のオブジェクトの識別に利用される128ビットの値です。
</p>
</dd>


<dt class="method-heading" id="I_HELPCONTEXT"><code>helpcontext -&gt; Integer | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/helpcontext.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-helpcontext">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
この型に関連するヘルプファイルのトピックID（ヘルプコンテキスト）を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型に関連するヘルプコンテキストを整数で返します。ヘルプコンテキストが登録されていない場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
puts tobj.helpcontext # =&gt; 131185
</pre>
</dd>


<dt class="method-heading" id="I_HELPFILE"><code>helpfile -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/helpfile.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-helpfile">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
オブジェクトに関連付けられたヘルプファイルのフルパス名。
</p>
<p>
ここで返されたヘルプファイルを表示するには、
<a href="../method/-w-i-n32-o-l-e/i/ole_show_help.html">WIN32OLE#ole_show_help</a>メソッドを呼び出します。
</p>
<p>
オブジェクトがヘルプファイルを持たない場合はnilを返します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
オブジェクトに関連付けられたヘルプファイルのフルパス名を文字列で返します。ヘルプファイルが未定義の場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
puts tobj.helpfile # =&gt; C:\...\VBAXL9.CHM
WIN32OLE.ole_show_help tobj.helpfile, tobj.helpcontext
# 注）WIN32OLE.ole_show_help(tobj) の呼び出しが望ましい
</pre>
<p>
当メソッドがフルパス名を返しても、ヘルプファイルがインストールされていない場合があることに注意してください。
</p>
<p>
また、返送値はOLEサーバの登録値をそのまま利用するため、Rubyのパス名形式（ディレクトリ区切りは「/」）ではなく、Windowsのパス名形式（ディレクトリ区切りは「\」）です。
</p>
</dd>


<dt class="method-heading" id="I_HELPSTRING"><code>helpstring -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/helpstring.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-helpstring">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型のドキュメント文字列を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
ドキュメント文字列を返します。未定義の場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Internet Controls', 'IWebBrowser')
p tobj.helpstring   # =&gt; &quot;Web Browser interface&quot;
</pre>
<p>
ドキュメント文字列は、コンテキストヘルプなどに利用可能な型の簡単な説明文です。
</p>
</dd>


<dt class="method-heading" id="I_IMPLEMENTED_OLE_TYPES"><code>implemented_ole_types -&gt; [WIN32OLE_TYPE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/implemented_ole_types.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-implemented_ole_types">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
この型が実装するインターフェイスを取得します。
</p>
<p>
implemented_ole_typesメソッドは、selfがCoClass（コンポーネントクラス）の場合、そのクラスが実装しているすべてのインターフェイスを返します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
クラスが実装するすべてのインターフェイスを<a href="../class/-w-i-n32-o-l-e_-t-y-p-e.html">WIN32OLE_TYPE</a>の配列として返します。この型がインターフェイスを実装しない場合は、空配列を返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
型属性が取得できない場合に通知します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
tobj.implemented_ole_types.map {|intf| intf.name} #=&gt; [&quot;_Worksheet&quot;, &quot;DocEvents&quot;]
</pre>
</dd>


<dt class="method-heading" id="I_INSPECT"><code>inspect -&gt; String</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/inspect.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-inspect">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
selfを説明的な文字列で表現します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
&quot;#&lt;WIN32OLE_TYPE&quot;と<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/to_s.html">WIN32OLE_TYPE#to_s</a>の結果を「:」で結合し、「&gt;」で閉じた文字列を返します。
</dd>
</dl>
<pre>
x = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
puts x.inspect #=&gt; #&lt;WIN32OLE_TYPE:Worksheet&gt;
</pre>
<p>
[SEE_ALSO] <a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/to_s.html">WIN32OLE_TYPE#to_s</a>
</p>
</dd>


<dt class="method-heading" id="I_MAJOR_VERSION"><code>major_version -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/major_version.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-major_version">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型のメジャーバージョン番号を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型のメジャーバージョン番号を整数で返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
型属性の読み取りに失敗すると通知します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Word 14.0 Object Library', 'Documents')
p tobj.major_version   # =&gt; 8
</pre>
</dd>


<dt class="method-heading" id="I_MINOR_VERSION"><code>minor_version -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/minor_version.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-minor_version">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型のマイナーバージョン番号を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型のマイナーバージョン番号を整数で返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
型属性の読み取りに失敗すると通知します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Word 14.0 Object Library', 'Documents')
p tobj.minor_version   # =&gt; 5
</pre>
</dd>


<dt class="method-heading" id="I_NAME"><code>name -&gt; String</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/name.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-name">rdoc</a>]</span></dt>
<dt class="method-heading"><code>to_s -&gt; String</code></dt>
<dd class="method-description">
<p>
selfの型名を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
selfの型名を文字列で返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
p tobj.name   # =&gt; &quot;Application&quot;
</pre>
</dd>


<dt class="method-heading" id="I_OLE_METHODS"><code>ole_methods -&gt; [WIN32OLE_METHOD]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_methods.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-ole_methods">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型が持つメソッドのメタデータを取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型が持つメソッドのメタデータを<a href="../class/-w-i-n32-o-l-e_-m-e-t-h-o-d.html">WIN32OLE_METHOD</a>の配列として返します。メソッドを持たない場合は空配列を返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
methods = tobj.ole_methods.map {|m| m.name }
                     # =&gt; ['QueryInterface', 'AddRef', 'Release',....]
</pre>
<p>
[SEE_ALSO] <a href="../class/-w-i-n32-o-l-e_-m-e-t-h-o-d.html">WIN32OLE_METHOD</a>
</p>
</dd>


<dt class="method-heading" id="I_OLE_TYPE"><code>ole_type -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_type.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-ole_type">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
selfの型の種類（TYPEKIND）を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
selfの型の種類を文字列で返します。情報が取得できない場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
p tobj.ole_type  # =&gt; Class
</pre>
<p>
ole_typeには以下があります。
</p>
<dl>
<dt>Enum</dt>
<dd>
<p>
列挙子（0）
</p>
</dd>
<dt>Record</dt>
<dd>
<p>
ユーザ定義型（メソッドを持たない構造体）（1）
</p>
</dd>
<dt>Module</dt>
<dd>
<p>
モジュール（静的関数やデータだけを保持）（2）
</p>
</dd>
<dt>Interface</dt>
<dd>
<p>
COMのインターフェイス（メソッド定義の集合）（3）
</p>
</dd>
<dt>Dispatch</dt>
<dd>
<p>
OLEオートメーションサーバ（4）
</p>
</dd>
<dt>Class</dt>
<dd>
<p>
コンポーネントクラス（InterfaceやDispatchの実装）（5）
</p>
</dd>
<dt>Alias</dt>
<dd>
<p>
他の型の別名（6）
</p>
</dd>
<dt>Union</dt>
<dd>
<p>
共用体（7）
</p>
</dd>
<dt>Max</dt>
<dd>
<p>
型の種類を示す列挙体の終端マーカ（8）
</p>
</dd>
</dl>
<p>
MaxはTYPEKINDの終端マーカなので意味を持ちません。
</p>
<p>
[SEE_ALSO] <a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/typekind.html">WIN32OLE_TYPE#typekind</a>
</p>
</dd>


<dt class="method-heading" id="I_OLE_TYPELIB"><code>ole_typelib -&gt; WIN32OLE_TYPELIB | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_typelib.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-ole_typelib">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
この型を登録してある型情報ライブラリ（TypeLib）を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
この型を登録しているTypeLibを<a href="../class/-w-i-n32-o-l-e_-t-y-p-e-l-i-b.html">WIN32OLE_TYPELIB</a>オブジェクトとして返します。見つからない場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
puts tobj.ole_typelib.name  # =&gt; 'Microsoft Excel 14.0 Object Library'
</pre>
</dd>


<dt class="method-heading" id="I_PROGID"><code>progid -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/progid.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-progid">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
selfのPROGIDを取得します。
</p>
<p>
PROGIDは、生成可能なOLEオートメーションサーバのCoClass（コンポーネントクラス）が持つレジストリ登録名です。<a href="../method/-w-i-n32-o-l-e/s/new.html">WIN32OLE.new</a>の引数に指定して
WIN32OLEオブジェクトを生成できます。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
selfのPROGIDを文字列で返します。selfがPROGIDを持たない、または
CoClassでない場合はnilを返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
p tobj.progid   # =&gt; &quot;Excel.Application.14&quot;
</pre>
<p>
この例は、ExcelのApplicationクラスが「Excel.Application.14」という
PROGIDを持つことを示します。
</p>
<p>
[SEE_ALSO] <a href="../method/-w-i-n32-o-l-e/s/new.html">WIN32OLE.new</a>
</p>
</dd>


<dt class="method-heading" id="I_SOURCE_OLE_TYPES"><code>source_ole_types -&gt; [WIN32OLE_TYPE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/source_ole_types.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-source_ole_types">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型が持つソースインターフェイスを取得します。
</p>
<p>
source_ole_typesメソッドは、selfがCoClass（コンポーネントクラス）の場合、そのクラスがサポートするすべてのソースインターフェイス（イベントの通知元となるインターフェイス）を返します。
</p>
<p>
ActiveXコントロールのようにイベント（<a href="../class/-w-i-n32-o-l-e_-e-v-e-n-t.html">WIN32OLE_EVENT</a>）をサポートしているコンポーネントクラスの場合は、このメソッドの呼び出しによりイベントインターフェイスを調べることが可能です。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
ソースインターフェイスを<a href="../class/-w-i-n32-o-l-e_-t-y-p-e.html">WIN32OLE_TYPE</a>の配列として返します。ソースインターフェイスを持たない場合は空配列を返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Worksheet')
tobj.source_ole_types.map {|intf| intf.name} #=&gt; [&quot;DocEvents&quot;]
</pre>
</dd>


<dt class="method-heading" id="I_SRC_TYPE"><code>src_type -&gt; String | nil</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/src_type.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-src_type">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
selfが他の型の別名ならば、元の型名を取得します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
selfが別名ならば元の型名を文字列で返します。別名でなければnilを返します。
</dd>
</dl>
<pre>
tobj =  WIN32OLE_TYPE.new('Microsoft Office 14.0 Object Library', 'MsoRGBType')
p tobj.src_type   # =&gt; &quot;I4&quot;
</pre>
<p>
この例は、OfficeのMsoRGBType型は符号付き32ビット整数（I4）の別名だということを示します。
</p>
</dd>


<dt class="method-heading" id="I_TYPEKIND"><code>typekind -&gt; Integer</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/typekind.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-typekind">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
selfの種類を示す値を取得します。
</p>
<p>
値の意味については、<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_type.html">WIN32OLE_TYPE#ole_type</a>を参照してください。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型の種類を示す数値を返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
型の種類（TYPEKIND）を取得できない場合に通知します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Word 14.0 Object Library', 'Documents')
p tobj.typekind   # =&gt; 4
</pre>
<p>
[SEE_ALSO] <a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/ole_type.html">WIN32OLE_TYPE#ole_type</a>
</p>
</dd>


<dt class="method-heading" id="I_VARIABLES"><code>variables -&gt; [WIN32OLE_VARIABLE]</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/variables.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-variables">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
型が持つ変数を取得します。
</p>
<p>
型がEnum（列挙型）やユーザ定義型の場合、メンバ変数の情報を
<a href="../class/-w-i-n32-o-l-e_-v-a-r-i-a-b-l-e.html">WIN32OLE_VARIABLE</a>オブジェクトの配列として返します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
型が持つ変数情報を<a href="../class/-w-i-n32-o-l-e_-v-a-r-i-a-b-l-e.html">WIN32OLE_VARIABLE</a>の配列として返します。変数を持たない場合は空配列を返します。
</dd>
<dt>[EXCEPTION] WIN32OLERuntimeError:</dt>
<dd>
型属性が取得できない場合に通知します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'XlSheetType')
vars = tobj.variables
vars.each do |v|
  puts &quot;#{v.name} = #{v.value}&quot;
end
</pre>
<p>
上記を実行すると以下の出力が得られます。
</p>
<pre>
xlChart = -4109
xlDialogSheet = -4116
xlExcel4IntlMacroSheet = 4
xlExcel4MacroSheet = 3
xlWorksheet = -4167
</pre>
<p>
[SEE_ALSO] <a href="../class/-w-i-n32-o-l-e_-v-a-r-i-a-b-l-e.html">WIN32OLE_VARIABLE</a>
</p>
</dd>


<dt class="method-heading" id="I_VISIBLE--3F"><code>visible? -&gt; bool</code><span class="permalink">[<a href="../method/-w-i-n32-o-l-e_-t-y-p-e/i/visible=3f.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/2.7.6/WIN32OLE_TYPE.html#method-i-visible-3F">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
この型が公開されているかどうかを照会します。
</p>
<dl>
<dt>[RETURN]</dt>
<dd>
公開されていれば真を返します。
</dd>
</dl>
<pre>
tobj = WIN32OLE_TYPE.new('Microsoft Excel 14.0 Object Library', 'Application')
p tobj.visible?  # =&gt; true
</pre>
</dd>


</dl>

</main>

<footer id="footer">
  <a rel="license" href="https://creativecommons.org/licenses/by/3.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/88x31.png" />
  </a>

  <a href="https://github.com/rurema/doctree/issues/new" id="feedback-link">フィードバックを送る</a>
  
  <script>if (window.URLSearchParams) { document.getElementById("feedback-link").search = new URLSearchParams({'body': document.location}); }</script>
</footer>
</body>
</html>
