<!DOCTYPE html>
<html lang="ja-JP">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Language" content="ja-JP">
  <link rel="stylesheet" type="text/css" href="../style.css">
  <link rel="icon" type="image/png" href="../rurema.png">
  
  <title>class DL::PtrData (Ruby 1.8.7)</title>
</head>
<body>

<p>
<a href="../doc/index.html">Ruby 1.8.7 リファレンスマニュアル</a>
&gt; <a href="../library/index.html">ライブラリ一覧</a>
&gt; <a href="../library/dl.html">dlライブラリ</a>
&gt; DL::PtrDataクラス
</p>


<h1>class DL::PtrData</h1>
<p>


クラスの継承リスト: DL::PtrData

      &lt; <a href="../class/-object.html">Object</a>
      

      &lt; <a href="../class/-kernel.html">Kernel</a>
      







</p>

<h2>要約</h2>
<p>
メモリ領域を表すクラスです。C 言語のポインタに相当します。
</p>



<h2>目次</h2>
<dl>

<dt>特異メソッド</dt>
<dd>

<a href="#S_MALLOC">malloc</a>

<a href="#S_NEW">new</a>

</dd>

<dt>インスタンスメソッド</dt>
<dd>

<a href="#I_--2B">+</a>

<a href="#I_--2B--40">+@</a>

<a href="#I_--2B--40">ptr</a>

<a href="#I_--2D">-</a>

<a href="#I_--2D--40">-@</a>

<a href="#I_--2D--40">ref</a>

<a href="#I_--3C--3D--3E"><=></a>

<a href="#I_--3D--3D">==</a>

<a href="#I_--3D--3D">eql?</a>

<a href="#I_--5B--5D">[]</a>

<a href="#I_--5B--5D--3D">[]=</a>

<a href="#I_DATA_TYPE">data_type</a>

<a href="#I_DEFINE_DATA_TYPE">define_data_type</a>

<a href="#I_FREE">free</a>

<a href="#I_FREE--3D">free=</a>

<a href="#I_NULL--3F">null?</a>

<a href="#I_SIZE">size</a>

<a href="#I_SIZE">size=</a>

<a href="#I_STRUCT--21">struct!</a>

<a href="#I_TO_A">to_a</a>

<a href="#I_TO_I">to_i</a>

<a href="#I_TO_S">to_s</a>

<a href="#I_TO_STR">to_str</a>

<a href="#I_UNION--21">union!</a>

</dd>

</dl>


<h2>特異メソッド</h2>
<dl>

<dt class="method-heading" id="S_MALLOC"><code>malloc(size, free = nil) -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/s/malloc.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-c-malloc">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
サイズが size であるメモリ領域を確保し、それを指す DL::PtrData を返します。
</p>
<dl>
<dt class='method-param'>[PARAM] size:</dt>
<dd>
確保したいメモリ領域のサイズを指定します。
</dd>
<dt class='method-param'>[PARAM] free:</dt>
<dd>
返り値にセットされる free 関数を <a href="../class/-d-l=3a=3a-symbol.html">DL::Symbol</a> で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="S_NEW"><code>new(addr, size = 0, free = nil) -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/s/new.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-c-new">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
アドレス addr を指すポインタに相当する PtrData オブジェクトを返します。
</p>
<p>
size を指定した場合、アドレス addr に確保されているメモリ領域のサイズは
size であるとします。
GC は free 関数を使用してメモリを解放します。
</p>
<dl>
<dt class='method-param'>[PARAM] addr:</dt>
<dd>
生成する PtrData オブジェクトが指すアドレスを整数で指定します。
</dd>
<dt class='method-param'>[PARAM] size:</dt>
<dd>
生成する PtrData オブジェクトが指すメモリ領域のサイズを整数で指定します。
</dd>
<dt class='method-param'>[PARAM] free:</dt>
<dd>
生成する PtrData オブジェクトの free 関数を <a href="../class/-d-l=3a=3a-symbol.html">DL::Symbol</a> で指定します。
</dd>
</dl>
</dd>


</dl>

<h2>インスタンスメソッド</h2>
<dl>

<dt class="method-heading" id="I_--2B"><code>self + n -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=2b.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-2B">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
自身のアドレスに n バイトを足した新しい PtrData オブジェクトを返します。
</p>
<p>
この返り値には、free 関数がセットされていません。
</p>
<dl>
<dt class='method-param'>[PARAM] n:</dt>
<dd>
アドレスの増分を整数で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_--2B--40"><code>ptr -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=2b=40.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-2B-40">rdoc</a>]</span></dt>
<dt class="method-heading"><code>+ self -&gt; DL::PtrData</code></dt>
<dd class="method-description">
<p>
自身の指す値を PtrData にして返します。
自身の指す値はポインタであると仮定します。
C 言語におけるポインタのポインタに対する間接参照 *p と同じです。
</p>
<p>
この返り値には、free 関数がセットされていません。
</p>
<pre>
a = ['abc', 'def'].to_ptr
p a.ptr.to_s #=&gt; &quot;abc&quot;
</pre>
</dd>


<dt class="method-heading" id="I_--2D"><code>self - n -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=2d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-2D">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
自身のアドレスから n バイトを引いた新しい PtrData オブジェクトを返します。
</p>
<p>
この返り値には、free 関数がセットされていません。
</p>
<dl>
<dt class='method-param'>[PARAM] n:</dt>
<dd>
アドレスの差分を整数で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_--2D--40"><code>ref -&gt; DL::PtrData</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=2d=40.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-2D-40">rdoc</a>]</span></dt>
<dt class="method-heading"><code>- self -&gt; DL::PtrData</code></dt>
<dd class="method-description">
<p>
自身を指す PtrData オブジェクトを返します。
C 言語におけるポインタへのアドレス演算子の適用 &amp;p と同じです。
</p>
<p>
この返り値には、free 関数がセットされていません。
</p>
<pre>
s = &quot;abc&quot;.to_ptr
p s == s.ref.ptr #=&gt; true
</pre>
</dd>


<dt class="method-heading" id="I_--3C--3D--3E"><code>self &lt;=&gt; other -&gt; Integer</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=3c=3d=3e.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-3C-3D-3E">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
ポインタの指すアドレスの大小を比較します。
</p>
</dd>


<dt class="method-heading" id="I_--3D--3D"><code>self == other -&gt; bool</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=3d=3d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-3D-3D">rdoc</a>]</span></dt>
<dt class="method-heading"><code>eql?(other) -&gt; bool</code></dt>
<dd class="method-description">
<p>
ポインタの指すアドレスが同一かどうかを判定します。
</p>
</dd>


<dt class="method-heading" id="I_--5B--5D"><code>self[key] -&gt; object</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-5B-5D">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
構造体または共用体メンバ key の値を返します。返り値は <a href="../method/-d-l=3a=3a-ptr-data/i/struct=21.html">DL::PtrData#struct!</a>
または <a href="../method/-d-l=3a=3a-ptr-data/i/union=21.html">DL::PtrData#union!</a> によって定義された型により、Ruby のオブジェクトへ
変換されたものです。
</p>
<dl>
<dt class='method-param'>[PARAM] key:</dt>
<dd>
取得したい構造体か共用体のメンバの名前を、シンボルか文字列を指定します。
</dd>
</dl>
</dd>
<dt class="method-heading" id="I_--5B--5D"><code>self[offset, len = 0] -&gt; String</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-5B-5D">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
自身の指すアドレスに offset バイトを足したメモリ領域の先頭 len バイトを複製し、
文字列として返します。(self + offset).to_s(len) と同等です。
offset + len が自身のサイズより小さいかを検証しません。
</p>
<dl>
<dt class='method-param'>[PARAM] offset:</dt>
<dd>
値を得たい領域の先頭のアドレスまでのオフセットを整数で与えます。
</dd>
<dt class='method-param'>[PARAM] len:</dt>
<dd>
値を得たい領域のサイズを指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_--5B--5D--3D"><code>self[key] = val</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d=3d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-5B-5D-3D">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
構造体または共用体メンバ key の値を val にします。
</p>
<dl>
<dt class='method-param'>[PARAM] key:</dt>
<dd>
構造体か共用体のメンバの名前を文字列かシンボルで指定します。
</dd>
<dt class='method-param'>[PARAM] val:</dt>
<dd>
自身のメンバにセットしたい値を指定します。
</dd>
</dl>
</dd>
<dt class="method-heading" id="I_--5B--5D--3D"><code>self[offset] = str</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d=3d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-5B-5D-3D">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
自身の指すアドレスに offset バイトを足したメモリ領域に
文字列 str をコピーします。コピー先の領域が str のサイズより大きいか検証しません。
</p>
<dl>
<dt class='method-param'>[PARAM] offset:</dt>
<dd>
書き換えたいメモリ領域のオフセットを整数で与えます。
</dd>
<dt class='method-param'>[PARAM] str:</dt>
<dd>
メモリ領域にセットしたいバイト列を文字列で指定します。
</dd>
</dl>
</dd>
<dt class="method-heading" id="I_--5B--5D--3D"><code>self[offset, len] = str</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d=3d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-5B-5D-3D">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
自身の指すアドレスに offset バイトを足したメモリ領域の先頭 len バイトに
文字列 str をコピーします。str のサイズが len より小さい場合は、残りの領域を 0 で埋めます。
コピー先の領域が len より大きいか検証しません。
</p>
<dl>
<dt class='method-param'>[PARAM] offset:</dt>
<dd>
書き換えたいメモリ領域のオフセットを整数で与えます。
</dd>
<dt class='method-param'>[PARAM] len:</dt>
<dd>
書き換えたいメモリ領域のサイズを整数で指定します。
</dd>
<dt class='method-param'>[PARAM] str:</dt>
<dd>
メモリ領域にセットしたいバイト列を文字列で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_DATA_TYPE"><code>data_type -&gt; [object]</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/data_type.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-data_type">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
使ってはいけません。
</p>
</dd>


<dt class="method-heading" id="I_DEFINE_DATA_TYPE"><code>define_data_type -&gt; nil</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/define_data_type.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-define_data_type">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
使ってはいけません。
</p>
</dd>


<dt class="method-heading" id="I_FREE"><code>free -&gt; DL::Symbol</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/free.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-free">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
GC がメモリを解放するのに使用するシンボルオブジェクト sym を返します。
sym は普通 PtrData#free= や PtrData.new によって設定されます。
</p>
</dd>


<dt class="method-heading" id="I_FREE--3D"><code>free=(sym)</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/free=3d.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-free-3D">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
GC が自身を解放するのに使う関数を <a href="../class/-d-l=3a=3a-symbol.html">DL::Symbol</a> で指定します。
</p>
<dl>
<dt class='method-param'>[PARAM] sym:</dt>
<dd>
自身を解放するのに使われる関数を <a href="../class/-d-l=3a=3a-symbol.html">DL::Symbol</a> で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_NULL--3F"><code>null? -&gt; bool</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/null=3f.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-null-3F">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
自身が NULL なら true を返します。そうでないなら false を返します。
</p>
</dd>


<dt class="method-heading" id="I_SIZE"><code>size -&gt; Integer</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/size.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-size">rdoc</a>]</span></dt>
<dt class="method-heading"><code>size=(s)</code></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
自身の指す領域のサイズを返します。
s を指定した場合は、自身の指す領域のサイズは s であると設定します。
ただし、自身が指すメモリのサイズが s になるように再割り当てはしません。
</p>
<dl>
<dt class='method-param'>[PARAM] s:</dt>
<dd>
自身が指すメモリのサイズを指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_STRUCT--21"><code>struct!(type, *members) -&gt; nil</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/struct=21.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-struct-21">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
構造体のメンバにメソッド <a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d.html">DL::PtrData#[]</a> でアクセスできるようにします。
C 言語における構造体のポインタへのキャストと同じです。
</p>
<pre>
ptr = DL.malloc(DL.sizeof('LL'))
ptr.struct!('LL', :tv_sec, :tv_usec)
ptr[:tv_sec] = 10
p ptr[:tv_sec] #=&gt; 10
</pre>
<dl>
<dt class='method-param'>[PARAM] type:</dt>
<dd>
構造体のメンバの型を文字列で指定します。型指定子は <a href="../class/-d-l.html">DL</a> を参照して下さい。
</dd>
<dt class='method-param'>[PARAM] members:</dt>
<dd>
メンバの名前を文字列かシンボルで指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_TO_A"><code>to_a(type) -&gt; [object]</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/to_a.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-to_a">rdoc</a>]</span></dt>
<dt class="method-heading"><code>to_a(type, size) -&gt; [object]</code></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
自身が指す領域から type で指定された型の配列を複製して返します。
type は 'S','P','I','L','D' そして 'F' のいずれかです。
size を指定した場合は、自身が指す領域からサイズが size である配列を
複製します。
</p>
<p>
size が自身のサイズより小さいかを検査しません。
</p>
<p>
type が定めされた型指定子でない場合、空の配列を返します。
</p>
<dl>
<dt class='method-param'>[PARAM] type:</dt>
<dd>
自身の要素の型を、長さが 1 の文字列で指定します。
</dd>
<dt class='method-param'>[PARAM] size:</dt>
<dd>
得たい配列のサイズを整数で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_TO_I"><code>to_i -&gt; Integer</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/to_i.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-to_i">rdoc</a>]</span></dt>
<dd class="method-description">
<p>
自身が指すアドレスを整数で返します。
</p>
</dd>


<dt class="method-heading" id="I_TO_S"><code>to_s -&gt; String</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/to_s.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-to_s">rdoc</a>]</span></dt>
<dt class="method-heading"><code>to_s(len) -&gt; String</code></dt>
<dd class="method-description">
<p>
自身が指す領域から長さ len の文字列を複製して返します。
</p>
<p>
len を省略した場合は、文字列の終りは '\0' であると仮定して、
<a class="external" href="http://www.opengroup.org/onlinepubs/009695399/functions/strlen.html">strlen(3)</a> を使って長さを算出します。
</p>
<dl>
<dt class='method-param'>[PARAM] len:</dt>
<dd>
文字列の長さを整数で指定します。
</dd>
</dl>
</dd>


<dt class="method-heading" id="I_TO_STR"><code>to_str</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/to_str.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-to_str">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
</dd>


<dt class="method-heading" id="I_UNION--21"><code>union!(type, *members) -&gt; nil</code><span class="permalink">[<a href="../method/-d-l=3a=3a-ptr-data/i/union=21.html">permalink</a>][<a href="http://docs.ruby-lang.org/en/1.8.7/DL/PtrData.html#method-i-union-21">rdoc</a>]</span></dt>
<dd class="method-description">
<p class="todo">
[TODO]
</p>
<p>
共用体のメンバにメソッド <a href="../method/-d-l=3a=3a-ptr-data/i/=5b=5d.html">DL::PtrData#[]</a> でアクセスできるようにします。
C 言語における共用体のポインタへのキャストと同じです。
</p>
<dl>
<dt class='method-param'>[PARAM] type:</dt>
<dd>
共用体の型を文字列で指定します。型指定子は <a href="../class/-d-l.html">DL</a> を参照して下さい。
</dd>
<dt class='method-param'>[PARAM] members:</dt>
<dd>
メンバの名前を文字列かシンボルで指定します。
</dd>
</dl>
</dd>


</dl>



<div id="footer">
  <a rel="license" href="https://creativecommons.org/licenses/by/3.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/88x31.png" />
  </a>
</div>
</body>
</html>
