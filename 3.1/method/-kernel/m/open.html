<!DOCTYPE html>
<html lang="ja-JP">
<head>

<meta name="robots" content="noindex">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../../../style.css">
<link rel="stylesheet" href="../../../syntax-highlight.css">
<link rel="icon" type="image/png" href="../../../rurema.png">

<title>Kernel.#open (Ruby 3.1.2 リファレンスマニュアル)</title>
<meta name="description" content="file をオープンして、[[c:IO]]（[[c:File]]を含む）クラスのインスタンスを返します。">
<script src="../../../script.js"></script>
</head>
<body>


<header>
  <nav>
    <ol class="inline-breadcrumb-list">
      <li>
        <a href="../../../doc/index.html">Ruby 3.1.2 リファレンスマニュアル</a>
      </li>
      <li>
        <a href="../../../library/index.html">ライブラリ一覧</a>
      </li>
      <li>
        <a href="../../../library/_builtin.html">組み込みライブラリ</a>
      </li>
      <li>
        <a href="../../../class/-kernel.html">Kernelモジュール</a>
      </li>
      <li>
        open 
      </li>
    </ol>
  </nav>

<h1>module function Kernel.#open</h1>
</header>

<main>
<dl class="methodlist">

<dt class="method-heading" id="M_OPEN"><code>open(file, mode_enc = &quot;r&quot;, perm = 0666) -&gt; IO</code><span class="permalink">[<a href="../../../method/-kernel/m/open.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.1.2/Kernel.html#method-c-open">rdoc</a>]</span></dt>
<dt class="method-heading"><code>open(file, mode_enc = &quot;r&quot;, perm = 0666) {|io| ... } -&gt; object</code></dt>
<dd class="method-description">
<p>
file をオープンして、<a href="../../../class/-i-o.html">IO</a>（<a href="../../../class/-file.html">File</a>を含む）クラスのインスタンスを返します。
</p>
<p>
ブロックが与えられた場合、指定されたファイルをオープンし、生成した <a href="../../../class/-i-o.html">IO</a> オブジェクトを引数としてブロックを実行します。ブロックの終了時や例外によりブロックを脱出するとき、ファイルをクローズします。ブロックを評価した結果を返します。
</p>
<p>
ファイル名 file が `|' で始まる時には続く文字列をコマンドとして起動し、コマンドの標準入出力に対してパイプラインを生成します
</p>
<p>
ファイル名が &quot;|-&quot; である時、open は Ruby の子プロセスを生成し、その子プロセスとの間のパイプ(<a href="../../../class/-i-o.html">IO</a>オブジェクト)を返します。(このときの動作は、<a href="../../../method/-i-o/s/popen.html">IO.popen</a> と同じです。
<a href="../../../method/-file/s/open.html">File.open</a> にはパイプラインを生成する機能はありません)。
</p>
<p>
Perlと異なりコマンドは常に `|' で始まります。
</p>
<dl>
<dt class='method-param'>[PARAM] file:</dt>
<dd>
ファイルを文字列で指定します。整数を指定した場合はファイルディスクリプタとして扱います。
</dd>
<dt class='method-param'>[PARAM] mode_enc:</dt>
<dd>
モード・エンコーディングを文字列か定数の論理和で指定します。後述。
</dd>
<dt class='method-param'>[PARAM] perm:</dt>
<dd>
<a class="external" href="http://www.opengroup.org/onlinepubs/009695399/functions/open.html">open(2)</a> の第 3 引数のように、ファイルを生成する場合のファイルのパーミッションを整数で指定します。
</dd>
<dt>[EXCEPTION] Errno::EXXX:</dt>
<dd>
ファイルのオープンに失敗した場合に発生します。
</dd>
</dl>
<p>
[SEE_ALSO] <a href="../../../method/-file/s/open.html">File.open</a>,<a href="../../../method/-i-o/s/popen.html">IO.popen</a>,<a href="../../../method/-i-o/s/open.html">IO.open</a>
</p>
<h2 >第二引数のオープンモード・エンコーディング</h2>
<p>
文字列(&quot;mode&quot; か &quot;mode:ext_enc&quot; か &quot;mode:ext_enc:int_enc&quot; という形式)か整数(<a href="../../../class/-file=3a=3a-constants.html">File::Constants</a> モジュールの定数の論理和)を組み合わせて指定します。
</p>
<p>
mode は以下の三つのうちのいずれかです。
</p>
<dl>
<dt>&quot;r&quot;, RDONLY</dt>
<dd>
<p>
ファイルを読み込みモードでオープンします。（デフォルトのモード）
</p>
</dd>
<dt>&quot;w&quot;, WRONLY|CREAT|TRUNC</dt>
<dd>
<p>
ファイルを書き込みモードでオープンします。オープン時にファイルがすでに存在していればその内容を空にします。
</p>
</dd>
<dt>&quot;a&quot;, WRONLY|CREAT|APPEND</dt>
<dd>
<p>
ファイルを書き込みモードでオープンします。出力は 常に ファイルの末尾に追加されます。例えば、ファイルオープン中にファイルのサイズが小さくなってもその末尾に出力されます。
</p>
</dd>
</dl>
<p>
以上の3つの後に &quot;+&quot; があれば、ファイルは読み書き両用モード (RDWR)
でオープンされます。
</p>
<dl>
<dt>&quot;r+&quot;</dt>
<dd>
<p>
ファイルの読み書き位置は先頭にセットされます。
</p>
</dd>
<dt>&quot;w+&quot;</dt>
<dd>
<p>
&quot;r+&quot; と同じですが、オープン時にファイルがすでに存在していればその内容を空にします。
</p>
</dd>
<dt>&quot;a+&quot;</dt>
<dd>
<p>
&quot;r+&quot;と同様、ファイルの読み込み位置は先頭にセットされますが、書き込みは常にファイル末尾に行われます。書き込みは
<a href="../../../method/-i-o/i/seek.html">IO#seek</a> などの影響を受けません。
</p>
</dd>
</dl>
<p>
これらのいずれに対しても &quot;b&quot; フラグを (&quot;r+b&quot;のように) つけることができます (整数なら File::BINARY )。この場合、バイナリモードでオープンします (ただし、DOS/Windowsのようにシステムがテキスト／バイナリでファイルを区別する場合に限ります)
</p>
<p>
&quot;w&quot; に対しては &quot;x&quot; フラグを (&quot;wx&quot;や&quot;wb+x&quot;のように) つけることができます (整数なら File::EXCL)。この場合、ファイルがすでに存在すると Errno::EEXIST が発生します。ただし、全ての種類のストリームでサポートされているとは限りません (例えばパイプ)。
</p>
<h2 >Universal Newline</h2>
<p>
改行をLFに揃えます。一言で言えばPEP:278 <a class="external" href="https://www.python.org/dev/peps/pep-0278/">https://www.python.org/dev/peps/pep-0278/</a>のことです。
</p>
<dl>
<dt>&quot;rt&quot;</dt>
<dd>
<p>
CR、LF、CRLFのいずれをもLFとして読み込む。
</p>
</dd>
<dt>&quot;rb&quot;</dt>
<dd>
<p>
CR、LF、CRLFはいずれもそのまま読み込まれる。
</p>
</dd>
<dt>&quot;r&quot;</dt>
<dd>
<p>
&quot;rt&quot;と&quot;rb&quot;のどちらの扱いになるかはプラットフォーム依存。
(Unix系ならばなら&quot;rb&quot;、mswinやmingwなら&quot;rt&quot;扱いとなる)
</p>
</dd>
<dt>&quot;wb&quot;</dt>
<dd>
<p>
LFはそのままLFとして書き込まれる。
</p>
</dd>
<dt>&quot;wt&quot; または &quot;w&quot;</dt>
<dd>
<p>
LFはLFのままか、CR+LFか、どちらかになる。どちらになるかはプラットフォーム依存。
(Unix系ならばLFのまま、mswinやmingwならばCRLFとなる)
</p>
</dd>
</dl>
<p>
なお、以上のCR、LF、CRLFは入力のエンコーディングを解釈した後に処理されます。例えば、UTF-16LEでは、LFはバイト列&quot;\x0a\x00&quot;のことになります。
</p>
<h2 >エンコーディングの指定</h2>
<p>
ext_enc(外部エンコーディング)が指定されている場合、読み込まれた文字列にはこのエンコーディングが指定され、出力する文字列はそのエンコーディングに変換されます。
</p>
<p>
ext_encが'BOM|'で始まる場合、その入力に含まれるBOMはあらかじめ削られます。また、BOMがあった場合、入力された文字列にはそのBOMに対応するエンコーディングが設定されます。
</p>
<pre class="highlight ruby">
<span class="caption">BOMでUTF-16BEかLEかを判別する例</span>
<code>
<span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"</span><span class="s2">utf16.txt</span><span class="s2">"</span>, <span class="s2">"</span><span class="s2">rb:BOM|utf-16</span><span class="s2">"</span><span class="p">)</span><span class="p">{</span><span class="o">|</span>file<span class="o">|</span> <span class="s2">"</span><span class="s2">...</span><span class="s2">"</span> <span class="p">}</span>
</code></pre>
<p>
int_encも指定されていた場合、入力された文字列をext_encでエンコーディングされた文字列とみなしてint_encへと変換し、その結果にint_encを設定して返します。
</p>
</dd>


</dl>
</main>

<footer id="footer">
  <a rel="license" href="https://creativecommons.org/licenses/by/3.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/88x31.png" />
  </a>

  <a href="https://github.com/rurema/doctree/issues/new" id="feedback-link">フィードバックを送る</a>
  
  <script>if (window.URLSearchParams) { document.getElementById("feedback-link").search = new URLSearchParams({'body': document.location}); }</script>
</footer>
</body>
</html>
